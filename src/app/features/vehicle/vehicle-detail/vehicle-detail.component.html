<div class="vehicle-detail-page">
  <div class="detail-content">
    <!-- Header Section -->
    <div class="header-section">
      <h2>รายละเอียดรถเก็บขยะ</h2>
      <p>ข้อมูลรายละเอียดของรถเก็บขยะ</p>
    </div>

    @if (loading()) {
    <!-- Skeleton Loading -->
    <div class="skeleton-container">
      <div class="skeleton-image"></div>
      <div class="skeleton-info">
        <div class="skeleton-line w-60"></div>
        <div class="skeleton-line w-40"></div>
        <div class="skeleton-line w-80"></div>
        <div class="skeleton-line w-50"></div>
        <div class="skeleton-line w-70"></div>
      </div>
    </div>
    } @else if (vehicle()) {
    <!-- Vehicle Image & Badge -->
    <div class="vehicle-hero">
      <div class="vehicle-image-wrapper">
        @if (vehicle()?.image || vehicle()?.image_url) {
        <img
          [src]="vehicle()?.image || vehicle()?.image_url"
          alt="รถเก็บขยะ"
          class="vehicle-image"
        />
        } @else {
        <div class="vehicle-image-placeholder">
          <mat-icon>local_shipping</mat-icon>
        </div>
        }
      </div>

      <div class="vehicle-badge">
        <span class="reg-number">{{ getRegNum() }}</span>
        <span
          class="status-badge"
          [class.active]="
            vehicle()?.status?.toLowerCase() === 'available' ||
            vehicle()?.status?.toLowerCase() === 'active'
          "
          [class.inuse]="vehicle()?.status?.toLowerCase() === 'in_use'"
          [class.maint]="
            vehicle()?.status?.toLowerCase() === 'maintenance' ||
            vehicle()?.status?.toLowerCase() === 'in_maintenance'
          "
          [class.decommissioned]="
            vehicle()?.status?.toLowerCase() === 'decommissioned'
          "
          (click)="changeStatus()"
        >
          <span class="dot"></span>
          {{ statusLabel(vehicle()?.status) }}
        </span>
      </div>
    </div>

    <!-- Vehicle Specifications -->
    <div class="info-section">
      <h3 class="section-title">ข้อมูลรถ</h3>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">รุ่นรถ</span>
          <span class="info-value">{{ vehicle()?.vehicle_type || "-" }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">เลขทะเบียน</span>
          <span class="info-value">{{ getRegNum() }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">ประเภทเชื้อเพลิง</span>
          <span class="info-value">{{ getFuelType() }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">ค่าเสื่อมราคา/ปี</span>
          <span class="info-value">฿{{ num(getDepreciation()) }}</span>
        </div>
        <div class="info-item capacity-item">
          <span class="info-label">ความจุขยะทั่วไป</span>
          <span class="info-value">{{ num(getRegularCapacity()) }} กก.</span>
        </div>
        <div class="info-item capacity-item">
          <span class="info-label">ความจุขยะรีไซเคิล</span>
          <span class="info-value">{{ num(getRecycleCapacity()) }} กก.</span>
        </div>
      </div>
    </div>

    <!-- Driver Section -->
    <div class="info-section">
      <h3 class="section-title">ข้อมูลคนขับ</h3>
      @if (driver()) {
      <div class="driver-card">
        <img
          class="driver-avatar"
          [src]="
            driver()?.s_image ||
            driver()?.picture ||
            '/assets/images/worker-avatar.png'
          "
          alt="driver"
        />
        <div class="driver-info">
          <div class="driver-name">
            {{ driver()?.firstname }} {{ driver()?.lastname }}
          </div>
          <div class="driver-role">พนักงานขับรถเก็บขยะ</div>
          <div class="driver-meta">
            รหัส: {{ staffCodeFromId(driver()?.id) }}
          </div>
          <div class="driver-meta">
            โทร: {{ driver()?.phone_number || "-" }}
          </div>
        </div>
      </div>
      } @else {
      <div class="empty-driver">
        <mat-icon>person_off</mat-icon>
        <span>ยังไม่ระบุพนักงานขับรถ</span>
      </div>
      }
    </div>

    <!-- Action Buttons -->
    <div class="actions-section">
      <div class="action-buttons">
        <button
          mat-stroked-button
          class="action-btn edit-btn"
          (click)="editVehicle()"
          [disabled]="loading()"
        >
          <mat-icon>edit</mat-icon>
          แก้ไขข้อมูล
        </button>
        <button
          mat-stroked-button
          class="action-btn driver-btn"
          (click)="editDriver()"
          [disabled]="loading()"
        >
          <mat-icon>person</mat-icon>
          เปลี่ยนคนขับ
        </button>
      </div>

      <div class="danger-buttons">
        <button
          mat-stroked-button
          class="action-btn status-btn"
          (click)="changeStatus()"
          [disabled]="loading()"
        >
          <mat-icon>swap_horiz</mat-icon>
          เปลี่ยนสถานะ
        </button>
        <button
          mat-stroked-button
          class="action-btn delete-btn"
          (click)="delete()"
          [disabled]="loading()"
        >
          <mat-icon>delete</mat-icon>
          ลบข้อมูล
        </button>
      </div>

      <button mat-button class="back-btn" (click)="back()">
        <mat-icon>arrow_back</mat-icon>
        กลับหน้ารายการ
      </button>
    </div>
    }
  </div>
</div>
